{%load static%}
<!doctype html>
<html class="no-js" lang="zxx">


<!-- Mirrored from htmldemo.net/payne/payne/cart.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 11 Oct 2023 15:26:56 GMT -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Bag World</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Favicons -->
    <link rel="shortcut icon" href="{%static 'assets/img/favicon.ico'%}" type="image/x-icon">
    <link rel="apple-touch-icon" href="{%static 'assets/img/icon.png">

    <!-- ************************* CSS Files ************************* -->

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="{%static 'assets/css/bootstrap.css'%}">

    <!-- Vendor CSS -->
    <link rel="stylesheet" href="{%static 'assets/css/vendor.css'%}">

    <!-- style css -->
    <link rel="stylesheet" href="{%static 'assets/css/main.css'%}">


    <style>
        .quantity-container {
            display: flex;
            align-items: center;
        }

        .decrement-button, .increment-button {
            border: none;
            background: none;
            font-size: 20px; /* Adjust the font size as needed */
            cursor: pointer;
        }

        .quantity-input {
            border: none; /* Remove the border */
            padding: 5px;
            width: 50px; /* Adjust the width as needed */
            text-align: center;
        }
    </style>

</head>

<body> 

    <!-- Preloader Start -->
    <!-- <div class="ft-preloader active">
        <div class="ft-preloader-inner h-100 d-flex align-items-center justify-content-center">
            <div class="ft-child ft-bounce1"></div>
            <div class="ft-child ft-bounce2"></div>
            <div class="ft-child ft-bounce3"></div>
        </div> -->
    </div>
    <!-- Preloader End -->

    <!-- Main Wrapper Start -->
    <div class="wrapper">
        <!-- Header Start -->
        <header class="header header-default site-header">
            <div class="header__outer">
                <div class="header__inner header--fixed">
                    <div class="container">
                        <div class="header__main">
                            <div class="header__col header__left">
                                <a href="index.html" class="logo">
                                    <figure class="logo--normal">
                                        <img src="{%static 'assets/img/logo/logo.png'%}" alt="Logo">
                                    </figure>
                                    <figure class="logo--transparency">
                                        <img src="{%static 'assets/assets/img/logo/logo.png'%}" alt="Logo">
                                    </figure>
                                </a>
                            </div>
                            <div class="header__col header__center">
                                <nav class="main-navigation d-none d-lg-block">
                                    <ul class="mainmenu">
                                        <li class="mainmenu__item menu-item-has-children position-relative">
                                            <a href="{%url 'user:home' %}" class="mainmenu__link">Home</a>
                                            <div class="inner-menu">
                                            </div>
                                        </li>
                                        <li class="mainmenu__item menu-item-has-children position-static">
                                            <a href="{%url 'user:shop' %}" class="mainmenu__link">Shop</a>
                                           
                                        
                                        <li class="mainmenu__item menu-item-has-children position-relative">
                                            <a href="#" class="mainmenu__link">Blog</a>
                                           
                                        </li>
                                        <!-- <li class="mainmenu__item">
                                            <a href="contact-us.html" class="mainmenu__link">Contact Us</a>
                                        </li> -->
                                    </li>
                                        
                                    {% if user.is_authenticated %}
                                        <li class="mainmenu__item menu-item-has-children position-relative">
                                            <a href="#" class="mainmenu__link">Pages</a>
                                            <div class="inner-menu">
                                                <ul class="sub-menu">
                                                    <li>
                                                        <a href="{% url 'user:user_profile' %}">My Account</a>
                                                    </li>
                                                    <li>
                                                        <a href="{%url 'cart:checkout'%}">Checkout</a>
                                                    </li>
                                                    <li>
                                                        <a href="{% url 'cart:cart' %}">Cart</a>
                                                    </li>
                                                    
                                                    <li>
                                                        <a href="{% url 'cart:wishlist' %}">Wishlist</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </li>
                                    {% endif %}

                                    </li>
                                    </ul>
                                </nav>
                            </div>
                            <!-- <div class="header__col header__right">
                                <div class="toolbar-item d-none d-lg-block">
                                    <a href="login-register.html" class="toolbar-btn">
                                        <span>Login</span>
                                    </a>
                                </div> -->
                                <div class="toolbar-item d-block d-lg-none">
                                    <a href="#offcanvasnav" class="hamburger-icon js-toolbar menu-btn">
                                        <span></span>
                                        <span></span>
                                        <span></span>
                                        <span></span>
                                        <span></span>
                                        <span></span>
                                    </a>
                                </div>
                                <div class="toolbar-item">
                                    <a href="{% url 'cart:wishlist' %}" class="toolbar-btn">
                                        <i class="flaticon-heart"></i>
                                    </a>
                              
                        </div>
                    </div>
                <div class="header-sticky-height"></div>
            </div>
        </header>
        <!-- Header End -->

        <!-- Breadcrumb area Start -->
        <section class="page-title-area bg-color" data-bg-color="#f4f4f4" style="background-color: rgb(244, 244, 244);">
            <div class="container">
                <div class="row">
                    <div class="col-12 text-center">
                        <!-- <h1 class="page-title">Cart</h1> -->
                        <ul class="breadcrumb">
                            <li><a href="{%url 'user:home' %}">Home</a></li>
                            <li class="current"><span>Cart</span></li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
        <!-- Breadcrumb area End -->
       

        <!-- Main Content Wrapper Start -->
        <div class="main-content-wrapper">
            <div class="page-content-inner ptb--80 pt-md--40 pb-md--60">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-8 mb-md--50">
                            <!-- <form class="cart-form" action="#" method="POST"> -->
                                {%csrf_token%}
                                <div class="row g-0">
                                    <div class="col-12">
                                        <div class="table-content table-responsive">
                                            <table class="table text-center">
                                                <thead>
                                                   
                                                    <tr>
                                                        <th>&nbsp;</th>
                                                        <th>&nbsp;</th>
                                                        <th class="text-start">Product</th>
                                                   
                                                        <th>price</th>
                                                        <th>quantity</th>
                                                        <!-- <th>Product Price</th> -->
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                 <!-- {% if messages %}
                                                        <ul class="messages">
                                                            {% for message in messages %}
                                                                 <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                                                            {% endfor %}
                                                        </ul>
                                                     {% endif %}
                         -->


                                                    {% for i in cart %}
                                                          <tr>
                                                            <form action="{% url 'cart:delete_cart_item' i.id %}" method="POST"> 
                                                                {% csrf_token %}
                                                                <td class="product-remove text-start">
                                                                    <button type="submit" style="border: none; background: none;">
                                                                        <i class="flaticon-cross" style="color: black;"></i>
                                                                    </button>
                                                                </td>
                                                            </form>
                                                            
                                                            
                                                            <td class="product-thumbnail text-start">
                                                                {% if i.product.product_quantity == 0 or i.product.is_deleted %}
                                                                    <del>
                                                                {% endif %}
                                                                <img src="{{ i.product.product_image.url }}" alt="Product Thumbnail" style="width: 70px; height: 88px;">
                                                                {% if i.product.product_quantity == 0 or i.product.is_deleted %}
                                                                    </del>
                                                                {% endif %}
                                                            </td>
                                                            
                                                            
                                                            
                                                            <td class="product-name text-start wide-column">
                                                                <h3>
                                                                    <a href="product-details.html">{{ i.product.product_name }}</a>
                                                                </h3>
                                                            </td>
                                                            
                                                            <td class="product-price">
                                                                <span class="product-price-wrapper">
                                                                    {%if i.offer_price%}
                                                                    <span class="money">{{ i.offer_price}}</span>
                                                                    {%else%}
                                                                    <span class="money">{{ i.product.product_price}}</span>
                                                                    {%endif%}
                                                                </span>
                                                            </td>



                                                            <td>
                                                                <div class="quantity-container">
                                                                    <button class="decrement-button" data-action="decrement" data-product-id="1" onclick="updateQuantity('{{i.product.id}}','decrease')">&#8722;</button>
                                                                    <input type="number" class="quantity-input" name="product_count" id="product_qty{{i.product.id}}" value="{{i.quantity}}" min="1" data-product-id="1" fdprocessedid="169ehu" readonly>
                                                                    <button class="increment-button" data-action="increment" data-product-id="1" onclick="updateQuantity('{{i.product.id}}','increase')">&#43;</button>
                                                                </div>
                                                            </td>
                                                            
                                                          
                                                            
                                                    </div>
                                                    <!-- <td class="product-total-price">
                                                        <span class="product-price-wrapper">
                                                            {%if i.offer_price%}
                                                            <span class="money">{{ i.offer_price}}</span>
                                                            {%else%}
                                                            <span class="money">{{ i.product.product_price}}</span>
                                                            {%endif%}
                                                        </span>
                                                    </td>
                                                             -->
                                                             <!-- <td class="product-total-price">
                                                                <span class="product-price-wrapper">
                                                                    {% if i.offer_price %}
                                                                        <span id="productTotal{{ i.product.id }}" class="money">{{ i.total_price }}</span>
                                                                    {% else %}
                                                                        <span id="productTotal{{ i.product.id }}" class="money">{{ i.product_total_price }}</span>
                                                                    {% endif %}
                                                                </span>
                                                            </td> -->
                                                            
                                                            
                                                            
                                                        </tr>
                                                    {% endfor %}
                                                </tbody>
                                                
                                            </table>
                                        </div>  
                                    </div>
                                </div>
                                <div class="row g-0 border-top pt--20 mt--20">
                                    <div class="col-sm-6">
                                        <!-- <P>THIS IS YOUR shippment address you want to make any changes then press the edit button</P>
                                        {% for i in user_profile %}
                                        {{ i.firstname }} {{ i.lastname }}<br>
                                        {{ i.streetaddress }}<br>
                                            {{ i.town }}, {{ i.state }}<br>
                                            {{ i.phone }}
                                            {{ i.email }}
                                            {{ i.ordernote }}<br>
                                            {{ i.company_name }}<br>
                                            {{ i.country }}<br>
                                            
                        
                                        {% endfor %} -->
                                    </div>
                                    
                                    <div class="col-sm-6 text-sm-end">
                                      
                                       
                                    </div>
                                </div>
                            <!-- </form> -->
                        </div>
                        <div class="col-lg-4">
                            <div class="cart-collaterals">
                                <div class="cart-totals">
                                    <h5 class="font-size-14 font-bold mb--15">Cart totals</h5>
                                    <div class="cart-calculator">
                                        <div class="cart-calculator__item">
                                            <div class="cart-calculator__item--head">
                                                <span>Subtotal</span>
                                            </div>
                                            <div class="cart-calculator__item--value">
                                                <span id="subTotal">${{total_price}}</span>
                                            </div>
                                        </div>
                                        <div class="cart-calculator__item">
                                            <div class="cart-calculator__item--head">
                                                <span>Shipping</span>
                                            </div>
                                            <div class="cart-calculator__item--value">
                                                <span>Flat rate: ${{shipping_charge}}</span>
                                                
                                            </div>
                                        </div>
                                        <div class="cart-calculator__item order-total">
                                            <div class="cart-calculator__item--head">
                                                <span>Total</span>
                                            </div>
                                            <div class="cart-calculator__item--value">
                                                <span class="product-price-wrapper">
                                                    <span id="cartTotal" class="money">${{ grand_total }}</span>
                                                </span>
                                            </div>
                                            
                                           
                                        </div>
                                    </div>
                                </div>
                                <a href="{%url 'cart:checkout'%}" class="btn btn-size-md btn-shape-square btn-fullwidth">
                                    Proceed To Checkout
                                </a>
                            </div>
                            
                        </div>

                    </div>
                    
                </div>
            </div>
        </div>
        
        <!-- Main Content Wrapper Start -->

        <!-- Footer Start-->
        <footer class="footer bg-color pt--70 pt-xs--60" data-bg-color="#f4f8fa">
            <div class="container">
                <div class="row border-bottom pb--60 pb-sm--28 pb-xs--49">
                    <div class="col footer-column-1 mb-sm--42">
                        <div class="footer-widget">
                            <div class="textwidget">
                                <figure class="footer-logo mb--10">
                                    <img src="{% static 'assets/img/logo/logo.png' %}" alt="Logo">
                                </figure>
                            </div>
                            <div class="address-widget">
                                <address>1203 Town Center Orive #L 335458 USA</address>
                                <a href="tel:+84112345678">+841 123 456 78</a>
                                <a href="mailto:info@company.com">info@company.com</a>
                            </div>
                        </div>
                    </div>
                    <div class="col footer-column-2 mb-md--33">
                        <div class="footer-widget">
                            <h3 class="widget-title mb--35 mb-sm--15">Store Menu</h3>
                            <ul class="footer-menu">
                                <li>
                                        <i class="fa fa-angle-right"></i>
                                        <span>Best Seller</span>
                                </li>
                                <li>
                                        <i class="fa fa-angle-right"></i>
                                        <span>New Arrivals</span>
                                </li>
                                <li>
                                        <i class="fa fa-angle-right"></i>
                                        <span>Men</span>
                                </li>
                                <li>
                                        <i class="fa fa-angle-right"></i>
                                        <span>Women</span>
                                </li>
                                <li>
                                        <i class="fa fa-angle-right"></i>
                                        <span>Accessories</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col footer-column-3 mb-sm--33">
                        <div class="footer-widget">
                            <h3 class="widget-title mb--35 mb-sm--15">Information</h3>
                            <ul class="footer-menu">
                                <li>
                                        <i class="fa fa-angle-right"></i>
                                        <span>About Us</span>
                                </li>
                                <li>
                                        <i class="fa fa-angle-right"></i>
                                        <span>Delivery Information</span>
                                </li>
                                <li>
                                        <i class="fa fa-angle-right"></i>
                                        <span>Privacy Policy</span>
                                </li>
                                <li>
                                        <i class="fa fa-angle-right"></i>
                                        <span>Terms &amp; Conditions</span>
                                </li>
                                <li>
                                        <i class="fa fa-angle-right"></i>
                                        <span>Look Books</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col footer-column-4 mb-xs--33">
                        <div class="footer-widget">
                            <h3 class="widget-title mb--35 mb-sm--15">Question</h3>
                            <div class="footer-widget">
                                <ul class="footer-menu">
                                    <li>
                                            <i class="fa fa-angle-right"></i>
                                            <span>Help</span>
                                    </li>
                                    <li>
                                            <i class="fa fa-angle-right"></i>
                                            <span>Track Order</span>
                                    </li>
                                    <li>
                                            <i class="fa fa-angle-right"></i>
                                            <span>Support</span>
                                    </li>
                                    <li>
                                            <i class="fa fa-angle-right"></i>
                                            <span>Shopping &amp; Delivery</span>
                                    </li>
                                    <li>
                                            <i class="fa fa-angle-right"></i>
                                            <span>FAQs</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col footer-column-5">
                        <div class="footer-widget">
                            <h3 class="widget-title mb--35 mb-sm--15">My Account</h3>
                            <ul class="footer-menu">
                                <li>
                                        <i class="fa fa-angle-right"></i>
                                        <span>My Account</span>
                                </li>
                                <li>
                                        <i class="fa fa-angle-right"></i>
                                        <span>Order Delivery</span>
                                </li>
                                <li>
                                        <i class="fa fa-angle-right"></i>
                                        <span>Wishlist</span>
                                </li>
                                <li>
                                        <i class="fa fa-angle-right"></i>
                                        <span>Newsletter</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="row ptb--20">
                    <div class="col-12 text-center">
                        <p class="copyright-text">&copy; Payne 2021 Made With <i class="fa fa-heart"></i> By
Hasthemes</p>
                        <div class="social space-10">
                            <a href="https://www.facebook.com/" target="_blank" rel="noopener noreferrer" class="social__link">
                                <i class="fa fa-facebook"></i>
                                <span class="sr-only">Facebook</span>
                            </a>
                            <a href="https://www.twitter.com/" target="_blank" rel="noopener noreferrer" class="social__link">
                                <i class="fa fa-twitter"></i>
                                <span class="sr-only">Twitter</span>
                            </a>
                            <a href="https://www.linkedin.com/" target="_blank" rel="noopener noreferrer" class="social__link">
                                <i class="fa fa-linkedin"></i>
                                <span class="sr-only">Linkedin</span>
                            </a>
                            <a href="https://www.instagram.com/" target="_blank" rel="noopener noreferrer" class="social__link">
                                <i class="fa fa-instagram"></i>
                                <span class="sr-only">Instagram</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Footer End-->

        <!-- OffCanvas Menu Start -->
        <aside class="offcanvas-navigation" id="offcanvasnav">
            <div class="offcanvas-navigation__inner">
                <a href="#" class="btn-close">
                    <i class="flaticon-cross"></i>
                    <span class="sr-only">Close Offcanvas Navigtion</span>
                </a>
                <div class="offcanvas-navigation__top">
                    <ul class="offcanvas-menu">
                        <li class="has-children">
                            <a href="{% url 'user:home' %}">
                                <span class="mm-text">Home</span>
                            </a>
                        </li>
                        
                        <li class="has-children">
                            <a href="{% url 'user:shop' %}">
                                <span class="mm-text">Shop</span>
                            </a>
                        </li>
                        
                        
                       
                        {% if user.is_authenticated %}
                        <li class="mainmenu__item menu-item-has-children position-relative">
                            <a href="#" class="mainmenu__link">Pages</a>
                            <div class="inner-menu">
                                <ul class="sub-menu">
                                    <li>
                                        <a href="{% url 'user:user_profile' %}">My Account</a>
                                    </li>
                                    <li>
                                        <a href="{%url 'cart:checkout'%}">Checkout</a>
                                    </li>
                                    <li>
                                        <a href="{% url 'cart:cart' %}">Cart</a>
                                    </li>
                                    
                                    
                                    
                                </ul>
                            </div>
                        </li>
                    {% endif %}
                    </ul>
                    </ul>
                </div>
            </div>
        </aside>
        <!-- OffCanvas Menu End -->

       
     


        <!-- Global Overlay Start -->
        <div class="global-overlay"></div>
        <!-- Global Overlay End -->

        <!-- Scroll To Top Start -->
        <a class="scroll-to-top" href="#"><i class="fa fa-angle-double-up"></i></a>
        <!-- Scroll To Top End -->
    </div>
    <!-- Main Wrapper End -->

    <!-- ************************* JS Files ************************* -->

    <!-- jQuery JS -->
    <script src="{%static 'assets/js/vendor1.js'%}"></script>

    <!-- Main JS -->
    <script src="{%static 'assets/js/main.js'%}"></script>




<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>



<script>
    function updateQuantity(productId, action) {
       
        const url = `/cart:update_cart/${action}/${productId}/`;
        const csrfToken = getCookie("csrftoken");
        
        fetch(url, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "X-CSRFToken": csrfToken,
            },

            
        
        })
        .then((response) => {
           
            
            /*if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }*/
            return response.json(); 
        })
        .then((data) => {
            if(data.error){
                if(data.error=='Product out of stock'){
                    const Toast = Swal.mixin({
                        toast: true,
                        position: "top-end",
                        showConfirmButton: false,
                        timer: 2000,  // Set timer to null to remove it
                        didOpen: (toast) => {
                            toast.onmouseenter = Swal.stopTimer;
                            toast.onmouseleave = Swal.resumeTimer;
                        }
                    });
    
                    Toast.fire({
                        icon: "warning",
                        title: "Not enough stock"
                    });
                }
                else{
                    const Toast = Swal.mixin({
                        toast: true,
                        position: "top-end",
                        showConfirmButton: false,
                        timer: 2000,  // Set timer to null to remove it
                        didOpen: (toast) => {
                            toast.onmouseenter = Swal.stopTimer;
                            toast.onmouseleave = Swal.resumeTimer;
                        }
                    });
    
                    Toast.fire({
                        icon: "warning",
                        title: "Minimum quantity should be 1"
                    });
            }
        }
            else{
                console.log(data)
                if (data && data.success) {
                    const { success, total, qnty,productId,subTotal } = data;
        
               
                    updateCartTotal( total,qnty,productId,subTotal);
                } else {
                    console.error("Invalid or missing data in the response.");
                }
            }
        })
            
           
           
        .catch((error) => {
            console.error("Error:", error);
        });
    }

    // Function to update the cart total
    function updateCartTotal(total,qnty ,productId,subTotal) {
        const totalShip = (parseInt(total)+20).toFixed(2)
        // Update the UI elements with the new subtotal and total values
        $("#subTotal").text(`$${total}`);
        $("#cartTotal").text(`$${totalShip}`);
      //  $("#cartTotal").text(total);
      
        $(`#product_qty${productId}`).val(qnty);
        $(`#productTotal${productId}`).text(subTotal);

    }

    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie !== "") {
            var cookies = document.cookie.split(";");
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === name + "=") {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>



<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        {% if messages %}
            {% for message in messages %}
                {% if message.tags == 'success' %}
                    const Toast = Swal.mixin({
                        toast: true,
                        position: "top-end",
                        showConfirmButton: false,
                        timer: 2000,  // Set timer to null to remove it
                        didOpen: (toast) => {
                            toast.onmouseenter = Swal.stopTimer;
                            toast.onmouseleave = Swal.resumeTimer;
                        }
                    });

                    Toast.fire({
                        icon: "success",
                        title: "{{ message }}"
                    });
                {% endif %}
            {% endfor %}
        {% endif %}
    });
</script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        {% if messages %}
            {% for message in messages %}
                {% if message.tags == 'error' %}
                    const Toast = Swal.mixin({
                        toast: true,
                        position: "top-end",
                        showConfirmButton: false,
                        timer: 2000,  // Set timer to null to remove it
                        didOpen: (toast) => {
                            toast.onmouseenter = Swal.stopTimer;
                            toast.onmouseleave = Swal.resumeTimer;
                        }
                    });

                    Toast.fire({
                        icon: "warning",
                        title: "{{ message }}"
                    });
                {% endif %}
            {% endfor %}
        {% endif %}
    });
</script>


        

</body>



</html>